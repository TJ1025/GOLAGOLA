<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GOLAGOLA - 랜덤 결정 도구</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @font-face {
            font-family: 'Cafe24Nyangi-W-v1.0';
            src: url('https://fastly.jsdelivr.net/gh/projectnoonnu/2410-1@1.0/Cafe24Nyangi-W-v1.0.woff2') format('woff2');
            font-weight: normal;
            font-style: normal;
        }
        @font-face {
            font-family: 'HancomMalangMalang-Regular';
            src: url('https://fastly.jsdelivr.net/gh/projectnoonnu/2406-1@1.0/HancomMalangMalang-Regular.woff2') format('woff2');
            font-weight: 400;
            font-style: normal;
        }
        body { 
            font-family: 'HancomMalangMalang-Regular', 'Inter', sans-serif; 
            background: linear-gradient(135deg, #6EE7B7, #3B82F6, #F472B6);
            background-size: 200% 200%;
            animation: gradientShift 15s ease infinite;
        }
        @keyframes gradientShift {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }
        .fade-in { 
            animation: fadeIn 1s ease-in; 
        }
        @keyframes fadeIn { 
            from { opacity: 0; transform: translateY(20px); } 
            to { opacity: 1; transform: translateY(0); } 
        }
        .btn-hover {
            transition: all 0.3s ease;
        }
        .btn-hover:hover {
            transform: scale(1.05);
            background-color: #EC4899;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        }
        .gola-font {
            font-family: 'Cafe24Nyangi-W-v1.0', sans-serif;
        }
    </style>
</head>
<body class="min-h-screen">
    <!-- 헤더 -->
    <header class="bg-white shadow-sm py-4 sticky top-0 z-10">
        <div class="container mx-auto px-4 flex justify-between items-center">
            <h1 class="text-2xl font-bold text-pink-500"><span class="gola-font">GOLAGOLA</span></h1>
            <nav>
                <ul class="flex space-x-6 text-gray-700 items-center">
                    <li><a href="index.html" class="hover:text-pink-500 transition">홈</a></li>
                    <li><a href="random.html" class="font-bold text-pink-500">랜덤 도구</a></li>
                    <li><a href="community.html" class="hover:text-pink-500 transition">커뮤니티</a></li>
                    <li id="authSection">
                        <a href="login.html" class="hover:text-pink-500 transition">로그인</a>
                        <span class="mx-2 text-gray-500">|</span>
                        <a href="signup.html" class="hover:text-pink-500 transition">회원가입</a>
                    </li>
                </ul>
            </nav>
        </div>
    </header>

    <!-- 메인 섹션 -->
    <section class="py-16">
        <div class="container mx-auto px-4">
            <h2 class="text-3xl font-bold text-white text-center mb-8 fade-in drop-shadow-lg">랜덤 결정 도구</h2>
            <p class="text-lg text-white text-center mb-12 max-w-2xl mx-auto fade-in drop-shadow">고민될 때 다양한 도구로 빠르고 재미있게 선택하세요!</p>

            <!-- 룰렛 -->
            <div class="bg-white bg-opacity-90 p-8 rounded-xl shadow-xl max-w-3xl mx-auto mb-12 fade-in">
                <h3 class="text-xl font-semibold text-gray-800 mb-4">룰렛 돌리기</h3>
                <input type="text" id="rouletteOptions" placeholder="옵션 입력 (쉼표로 구분, 예: 짜장면,짬뽕,탕수육)" class="w-full p-3 border rounded-lg mb-4 focus:outline-none focus:ring-2 focus:ring-pink-300">
                <canvas id="rouletteCanvas" width="300" height="300" class="mx-auto mb-4"></canvas>
                <button onclick="spinRoulette()" class="bg-pink-500 text-white px-6 py-3 rounded-lg font-semibold btn-hover">돌리기</button>
            </div>

            <!-- 사다리타기 -->
            <div class="bg-white bg-opacity-90 p-8 rounded-xl shadow-xl max-w-3xl mx-auto mb-12 fade-in">
                <h3 class="text-xl font-semibold text-gray-800 mb-4">사다리타기</h3>
                <input type="text" id="ladderParticipants" placeholder="참가자 입력 (쉼표로 구분, 예: 철수,영희,민수)" class="w-full p-3 border rounded-lg mb-4 focus:outline-none focus:ring-2 focus:ring-pink-300">
                <input type="text" id="ladderResults" placeholder="결과 입력 (쉼표로 구분, 예: 짜장면,짬뽕,탕수육)" class="w-full p-3 border rounded-lg mb-4 focus:outline-none focus:ring-2 focus:ring-pink-300">
                <canvas id="ladderCanvas" width="300" height="300" class="mx-auto mb-4"></canvas>
                <button onclick="drawLadder()" class="bg-pink-500 text-white px-6 py-3 rounded-lg font-semibold btn-hover">사다리 시작</button>
            </div>

            <!-- 레이스 -->
            <div class="bg-white bg-opacity-90 p-8 rounded-xl shadow-xl max-w-3xl mx-auto mb-12 fade-in">
                <h3 class="text-xl font-semibold text-gray-800 mb-4">레이스</h3>
                <input type="text" id="raceOptions" placeholder="옵션 입력 (쉼표로 구분, 예: 짜장면,짬뽕,탕수육)" class="w-full p-3 border rounded-lg mb-4 focus:outline-none focus:ring-2 focus:ring-pink-300">
                <div id="raceTrack" class="space-y-4 mb-4"></div>
                <button onclick="startRace()" class="bg-pink-500 text-white px-6 py-3 rounded-lg font-semibold btn-hover">레이스 시작</button>
            </div>

            <!-- 줄서기 -->
            <div class="bg-white bg-opacity-90 p-8 rounded-xl shadow-xl max-w-3xl mx-auto mb-12 fade-in">
                <h3 class="text-xl font-semibold text-gray-800 mb-4">줄서기</h3>
                <input type="text" id="queueOptions" placeholder="옵션 입력 (쉼표로 구분, 예: 짜장면,짬뽕,탕수육)" class="w-full p-3 border rounded-lg mb-4 focus:outline-none focus:ring-2 focus:ring-pink-300">
                <div id="queueResult" class="space-y-2 mb-4"></div>
                <button onclick="startQueue()" class="bg-pink-500 text-white px-6 py-3 rounded-lg font-semibold btn-hover">줄세우기</button>
            </div>

            <!-- 뽑기 -->
            <div class="bg-white bg-opacity-90 p-8 rounded-xl shadow-xl max-w-3xl mx-auto mb-12 fade-in">
                <h3 class="text-xl font-semibold text-gray-800 mb-4">뽑기</h3>
                <input type="text" id="drawOptions" placeholder="옵션 입력 (쉼표로 구분, 예: 짜장면,짬뽕,탕수육)" class="w-full p-3 border rounded-lg mb-4 focus:outline-none focus:ring-2 focus:ring-pink-300">
                <div id="drawResult" class="text-center text-lg font-semibold text-gray-800 mb-4"></div>
                <button onclick="startDraw()" class="bg-pink-500 text-white px-6 py-3 rounded-lg font-semibold btn-hover">뽑기</button>
            </div>

            <!-- 복불복 -->
            <div class="bg-white bg-opacity-90 p-8 rounded-xl shadow-xl max-w-3xl mx-auto mb-12 fade-in">
                <h3 class="text-xl font-semibold text-gray-800 mb-4">복불복</h3>
                <input type="text" id="luckOptions" placeholder="옵션 입력 (쉼표로 구분, 예: 당첨,꽝)" class="w-full p-3 border rounded-lg mb-4 focus:outline-none focus:ring-2 focus:ring-pink-300">
                <div id="luckResult" class="text-center text-lg font-semibold text-gray-800 mb-4"></div>
                <button onclick="startLuck()" class="bg-pink-500 text-white px-6 py-3 rounded-lg font-semibold btn-hover">복불복 시작</button>
            </div>
        </div>
    </section>

    <!-- 푸터 -->
    <footer class="bg-gray-800 text-white py-4">
        <div class="container mx-auto px-4 text-center">
            <p>© GOLAGOLA. All rights reserved.</p>
        </div>
    </footer>

    <!-- JavaScript -->
    <script>
        // 로그인 상태 확인
        function checkLoginStatus() {
            const loggedInUser = localStorage.getItem('loggedInUser');
            const authSection = document.getElementById('authSection');
            if (loggedInUser) {
                const user = JSON.parse(localStorage.getItem('user_' + loggedInUser));
                authSection.innerHTML = `
                    <span class="text-pink-500">${user.name}님</span>
                    <span class="mx-2 text-gray-500">|</span>
                    <button onclick="logout()" class="text-gray-700 hover:text-pink-500 transition">로그아웃</button>
                `;
            }
        }

        function logout() {
            localStorage.removeItem('loggedInUser');
            alert('로그아웃되었습니다!');
            window.location.href = 'index.html';
        }

        function spinRoulette() {
            const canvas = document.getElementById('rouletteCanvas');
            const ctx = canvas.getContext('2d');
            const optionsInput = document.getElementById('rouletteOptions').value;
            const options = optionsInput.split(',').map(opt => opt.trim()).filter(opt => opt);
            
            if (options.length < 2) {
                alert('최소 2개의 옵션을 입력해주세요!');
                return;
            }

            const colors = ['#6EE7B7', '#FBCFE8', '#A7F3D0', '#FECACA', '#E5E7EB'];
            const arc = Math.PI * 2 / options.length;
            let startAngle = 0;

            ctx.clearRect(0, 0, canvas.width, canvas.height);
            for (let i = 0; i < options.length; i++) {
                ctx.beginPath();
                ctx.fillStyle = colors[i % colors.length];
                ctx.moveTo(150, 150);
                ctx.arc(150, 150, 150, startAngle, startAngle + arc);
                ctx.fill();
                ctx.fillStyle = 'black';
                ctx.font = '16px Inter';
                ctx.fillText(options[i], 150 + Math.cos(startAngle + arc / 2) * 100, 150 + Math.sin(startAngle + arc / 2) * 100);
                startAngle += arc;
            }

            let rotation = 0;
            const spinTime = 3000;
            const start = Date.now();
            const spin = setInterval(() => {
                rotation += 0.1;
                canvas.style.transform = `rotate(${rotation}rad)`;
                if (Date.now() - start > spinTime) {
                    clearInterval(spin);
                    const selectedIndex = Math.floor(Math.random() * options.length);
                    alert(`선택된 결과: ${options[selectedIndex]}`);
                }
            }, 50);
        }

        function drawLadder() {
            const canvas = document.getElementById('ladderCanvas');
            const ctx = canvas.getContext('2d');
            const participantsInput = document.getElementById('ladderParticipants').value;
            const resultsInput = document.getElementById('ladderResults').value;
            const participants = participantsInput.split(',').map(p => p.trim()).filter(p => p);
            const results = resultsInput.split(',').map(r => r.trim()).filter(r => r);

            if (participants.length < 2 || results.length !== participants.length) {
                alert('참가자와 결과는 같은 수로 입력해주세요!');
                return;
            }

            ctx.clearRect(0, 0, canvas.width, canvas.height);
            const step = 300 / (participants.length + 1);
            for (let i = 1; i <= participants.length; i++) {
                ctx.beginPath();
                ctx.moveTo(i * step, 50);
                ctx.lineTo(i * step, 250);
                ctx.stroke();
                ctx.fillStyle = 'black';
                ctx.font = '14px Inter';
                ctx.fillText(participants[i - 1], i * step - 20, 40);
                ctx.fillText(results[i - 1], i * step - 20, 270);
            }

            for (let i = 1; i < participants.length; i++) {
                ctx.beginPath();
                ctx.moveTo(i * step, 100);
                ctx.lineTo((i + 1) * step, 100);
                ctx.stroke();
            }

            const shuffledResults = results.sort(() => Math.random() - 0.5);
            alert(`결과: ${participants.map((p, i) => `${p} → ${shuffledResults[i]}`).join('\n')}`);
        }

        function startRace() {
            const raceTrack = document.getElementById('raceTrack');
            const optionsInput = document.getElementById('raceOptions').value;
            const options = optionsInput.split(',').map(opt => opt.trim()).filter(opt => opt);

            if (options.length < 2) {
                alert('최소 2개의 옵션을 입력해주세요!');
                return;
            }

            raceTrack.innerHTML = '';
            options.forEach((option, index) => {
                const track = document.createElement('div');
                track.className = 'relative h-10 bg-gray-200 rounded-lg overflow-hidden';
                const runner = document.createElement('div');
                runner.className = 'absolute h-full bg-pink-500 text-white text-sm flex items-center px-2 transition-all duration-2000';
                runner.style.width = '0%';
                runner.textContent = option;
                track.appendChild(runner);
                raceTrack.appendChild(track);
            });

            setTimeout(() => {
                const runners = raceTrack.querySelectorAll('.bg-pink-500');
                const winnerIndex = Math.floor(Math.random() * options.length);
                runners.forEach((runner, index) => {
                    runner.style.width = index === winnerIndex ? '100%' : `${Math.random() * 80 + 10}%`;
                });
                setTimeout(() => {
                    alert(`우승: ${options[winnerIndex]}`);
                }, 2100);
            }, 100);
        }

        function startQueue() {
            const queueResult = document.getElementById('queueResult');
            const optionsInput = document.getElementById('queueOptions').value;
            const options = optionsInput.split(',').map(opt => opt.trim()).filter(opt => opt);

            if (options.length < 2) {
                alert('최소 2개의 옵션을 입력해주세요!');
                return;
            }

            const shuffled = options.sort(() => Math.random() - 0.5);
            queueResult.innerHTML = shuffled.map((opt, index) => `
                <div class="flex items-center space-x-2">
                    <span class="text-pink-500 font-semibold">${index + 1}등</span>
                    <span>${opt}</span>
                </div>
            `).join('');
        }

        function startDraw() {
            const drawResult = document.getElementById('drawResult');
            const optionsInput = document.getElementById('drawOptions').value;
            const options = optionsInput.split(',').map(opt => opt.trim()).filter(opt => opt);

            if (options.length < 1) {
                alert('최소 1개의 옵션을 입력해주세요!');
                return;
            }

            drawResult.textContent = '뽑는 중...';
            setTimeout(() => {
                const selected = options[Math.floor(Math.random() * options.length)];
                drawResult.textContent = `뽑힌 결과: ${selected}`;
            }, 1000);
        }

        function startLuck() {
            const luckResult = document.getElementById('luckResult');
            const optionsInput = document.getElementById('luckOptions').value;
            const options = optionsInput.split(',').map(opt => opt.trim()).filter(opt => opt);

            if (options.length < 1) {
                alert('최소 1개의 옵션을 입력해주세요!');
                return;
            }

            luckResult.textContent = '복불복 진행 중...';
            setTimeout(() => {
                const isLucky = Math.random() > 0.3;
                const selected = isLucky ? options[Math.floor(Math.random() * options.length)] : '꽝!';
                luckResult.textContent = `결과: ${selected}`;
            }, 1000);
        }

        // 페이지 로드 시 URL 파라미터 처리
        window.onload = function() {
            checkLoginStatus();
            const urlParams = new URLSearchParams(window.location.search);
            const options = urlParams.get('options');
            if (options) {
                document.getElementById('rouletteOptions').value = decodeURIComponent(options);
            }
        };
    </script>
</body>
</html>
